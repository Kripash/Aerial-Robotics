<?xml version="1.0" encoding="UTF-8"?>
<launch>
  <arg name="camera_name" default="/ptgrey_node/cam"/>
  <arg name="camera_frame" default="camera"/>
  <arg name="image_topic" default="image_raw"/>
  <arg name="cam_info_topic" default="camera_info"/>
  <arg name="landing_pad_frame" default="landing_pad"/>

  <node pkg="tf" type="static_transform_publisher" name="landing_pad_tf" args="0 0 0 0 0 0 $(arg camera_frame) $(arg landing_pad_frame) 100"/>

  <node name="detector" pkg="apriltag_detect" type="detector" output="screen">
    <param name="parent_frame"      value="$(arg camera_frame)" type="str"/>
    <param name="child_frame"       value="tag" type="str"/>
    <param name="pose_topic"        value="pose" type="str"/>
    <param name="error_topic"       value="error" type="str"/>
    <param name="landing_pad_frame" value="$(arg landing_pad_frame)" type="str"/>

    <rosparam command="load" file="$(find apriltag_detect)/config/settings.yaml" />

    <remap from="image_rect"        to="$(arg camera_name)/$(arg image_topic)" />
    <remap from="camera_info"       to="$(arg camera_name)/$(arg cam_info_topic)" />
  </node>

  <node type="rviz" name="rviz" pkg="rviz" args="-d $(find apriltag_detect)/rviz/detector.rviz" />
</launch>
